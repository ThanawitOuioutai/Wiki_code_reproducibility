"""
Created by Dimitri Perrin, September 2022
Modified by Thanawit Ouioutai (n10739921), October 2022
"""

import glob, subprocess, datetime, ast
from bs4 import BeautifulSoup as bs



# Input and output folders. Note: make sure you are using the correct folders
# folder_in = "/Users/thanawitouioutai/HPC_demo/"
# folder_out = "/Users/thanawitouioutai/HPC_demo/"
folder_in = "/work/wikidata/extracted_files_n10739921/"
folder_out = "/work/wikidata/extracted_files_n10739921/out_csv_files/"

# List of files to process

# Hard-coded files
files = ['enwiki-20220201-pages-meta-history10.xml-p4045403p4098716.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4098717p4150403.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4150404p4200322.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4200323p4250840.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4250841p4304045.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4304046p4358524.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4358525p4412161.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4412162p4460589.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4460590p4516856.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4516857p4566914.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4566915p4622343.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4622344p4667581.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4667582p4723108.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4723109p4777315.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4777316p4844848.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4844849p4905509.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4905510p4966004.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p4966005p5027616.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5027617p5043556.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5043557p5093020.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5093021p5137515.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5137516p5149117.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5149118p5207324.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5207325p5268854.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5268855p5327883.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5327884p5392294.V2notext', 'enwiki-20220201-pages-meta-history10.xml-p5392295p5399366.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5399367p5461764.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5461765p5524993.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5524994p5586733.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5586734p5643617.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5643618p5705867.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5705868p5761331.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5761332p5810570.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5810571p5872228.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5872229p5931800.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5931801p5987357.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p5987358p6041093.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6041094p6103321.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6103322p6165748.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6165749p6231043.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6231044p6304173.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6304174p6374378.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6374379p6447205.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6447206p6523095.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6523096p6595667.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6595668p6678847.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6678848p6737177.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6737178p6771241.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6771242p6837996.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6837997p6905712.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6905713p6981108.V2notext', 'enwiki-20220201-pages-meta-history11.xml-p6981109p7054859.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7054860p7132909.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7132910p7212027.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7212028p7299782.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7299783p7387085.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7387086p7466130.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7466131p7538147.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7538148p7621355.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7621356p7704752.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7704753p7781352.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7781353p7870537.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7870538p7952747.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p7952748p8031032.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8031033p8118428.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8118429p8204981.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8204982p8285442.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8285443p8377630.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8377631p8468074.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8468075p8550923.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8550924p8634851.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8634852p8716590.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8716591p8799497.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8799498p8878580.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8878581p8967486.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p8967487p9031312.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p9031313p9125942.V2notext', 'enwiki-20220201-pages-meta-history12.xml-p9125943p9172788.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10047274p10140800.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10140801p10240944.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10240945p10351065.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10351066p10440797.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10440798p10526584.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10526585p10631755.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10631756p10714682.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10714683p10820668.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10820669p10929193.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p10929194p11015778.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11015779p11080697.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11080698p11177083.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11177084p11262384.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11262385p11366731.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11366732p11424977.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11424978p11534389.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11534390p11636078.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p11636079p11659682.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9172789p9268319.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9268320p9366698.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9366699p9456483.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9456484p9549345.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9549346p9647256.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9647257p9754046.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9754047p9861137.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9861138p9940246.V2notext', 'enwiki-20220201-pages-meta-history13.xml-p9940247p10047273.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p11659683p11766644.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p11766645p11870992.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p11870993p11972133.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p11972134p12059480.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12059481p12153665.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12153666p12248018.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12248019p12353678.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12353679p12450611.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12450612p12546395.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12546396p12646867.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12646868p12755269.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12755270p12854271.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12854272p12952100.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p12952101p13032345.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13032346p13137015.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13137016p13148523.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13148524p13185374.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13185375p13280931.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13280932p13394870.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13394871p13506463.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13506464p13626072.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13626073p13744567.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13744568p13787974.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13787975p13916479.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p13916480p14042350.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p14042351p14176759.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p14176760p14290372.V2notext', 'enwiki-20220201-pages-meta-history14.xml-p14290373p14324602.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p14324603p14456927.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p14456928p14571890.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p14571891p14690609.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p14690610p14796629.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p14796630p14927199.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p14927200p15051440.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15051441p15167657.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15167658p15289814.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15289815p15406278.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15406279p15513278.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15513279p15630296.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15630297p15749557.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15749558p15860396.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15860397p15974076.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p15974077p16094852.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16094853p16245396.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16245397p16300734.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16300735p16458505.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16458506p16632781.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16632782p16772559.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16772560p16896867.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16896868p16940559.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p16940560p17075646.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p17075647p17210189.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p17210190p17338572.V2notext', 'enwiki-20220201-pages-meta-history15.xml-p17338573p17460152.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p17460153p17604395.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p17604396p17735798.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p17735799p17862143.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p17862144p17999753.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p17999754p18134799.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18134800p18277524.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18277525p18408029.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18408030p18513031.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18513032p18562238.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18562239p18654338.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18654339p18762511.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18762512p18861770.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18861771p18949259.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18949260p18999669.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p18999670p19116063.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19116064p19221338.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19221339p19328133.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19328134p19403070.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19403071p19541254.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19541255p19648982.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19648983p19732552.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19732553p19863736.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19863737p19994781.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p19994782p20124699.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p20124700p20275721.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p20275722p20435857.V2notext', 'enwiki-20220201-pages-meta-history16.xml-p20435858p20570392.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p20570393p20683175.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p20683176p20799542.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p20799543p20903758.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p20903759p21015037.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21015038p21115613.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21115614p21234435.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21234436p21349171.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21349172p21467621.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21467622p21583764.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21583765p21719260.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21719261p21845472.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21845473p21982126.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p21982127p22110006.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22110007p22238459.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22238460p22363537.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22363538p22496102.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22496103p22631284.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22631285p22747424.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22747425p22877793.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22877794p22998107.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p22998108p23133650.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p23133651p23259672.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p23259673p23335509.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p23335510p23454757.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p23454758p23565990.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p23565991p23684208.V2notext', 'enwiki-20220201-pages-meta-history17.xml-p23684209p23716197.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p23716198p23842298.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p23842299p23960663.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p23960664p24082289.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p24082290p24202291.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p24202292p24339034.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p24339035p24472950.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p24472951p24606666.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p24606667p24728349.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p24728350p24885779.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p24885780p25022726.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25022727p25160022.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25160023p25282279.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25282280p25439731.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25439732p25576992.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25576993p25684033.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25684034p25686095.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25686096p25814032.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25814033p25956182.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p25956183p26103202.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p26103203p26247830.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p26247831p26388818.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p26388819p26540753.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p26540754p26692387.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p26692388p26832716.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p26832717p26990853.V2notext', 'enwiki-20220201-pages-meta-history18.xml-p26990854p27121850.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p27121851p27287409.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p27287410p27430410.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p27430411p27590568.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p27590569p27698491.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p27698492p27866703.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p27866704p28006178.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p28006179p28148529.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p28148530p28291384.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p28291385p28454029.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p28454030p28676705.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p28676706p28838129.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p28838130p28991466.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p28991467p29170546.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p29170547p29355072.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p29355073p29519919.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p29519920p29697325.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p29697326p29909262.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p29909263p30100639.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p30100640p30266143.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p30266144p30427400.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p30427401p30602949.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p30602950p30761109.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p30761110p30865082.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p30865083p30965683.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p30965684p31116613.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p31116614p31274717.V2notext', 'enwiki-20220201-pages-meta-history19.xml-p31274718p31308442.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p10821p11460.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p11461p12105.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p12106p12964.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p12965p13644.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p13645p14194.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p14195p14704.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p14705p15301.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p15302p15921.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p15922p16473.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p16474p17179.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p1650p2403.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p17180p18018.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p18019p18869.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p18870p19451.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p19452p20067.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p1p857.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p20068p20938.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p20939p21482.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p21483p22263.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p22264p22991.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p22992p23544.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p23545p24323.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p2404p3385.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p24324p25392.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p25393p25784.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p25785p26588.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p26589p27008.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p27009p27743.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p27744p28506.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p28507p29475.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p29476p30117.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p30118p30838.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p30839p31723.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p31724p32140.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p32141p32745.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p32746p33587.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p33588p34357.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p3386p4156.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p34358p34857.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p34858p37284.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p37285p38275.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p38276p39666.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p39667p40303.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p40304p41242.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p4157p4652.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p4653p5352.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p5353p5945.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p5946p6793.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p6794p7712.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p7713p8484.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p8485p9252.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p858p1649.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p9253p9891.V2notext', 'enwiki-20220201-pages-meta-history1.xml-p9892p10820.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p31308443p31474253.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p31474254p31579718.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p31579719p31724591.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p31724592p31827440.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p31827441p31947187.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p31947188p32093952.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p32093953p32186887.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p32186888p32358804.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p32358805p32527628.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p32527629p32692051.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p32692052p32862728.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p32862729p33033434.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p33033435p33195933.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p33195934p33366002.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p33366003p33537512.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p33537513p33697475.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p33697476p33865723.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p33865724p34005648.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p34005649p34171962.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p34171963p34320835.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p34320836p34483819.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p34483820p34634894.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p34634895p34745520.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p34745521p34930214.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p34930215p35076272.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p35076273p35253737.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p35253738p35477633.V2notext', 'enwiki-20220201-pages-meta-history20.xml-p35477634p35522432.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p35522433p35696568.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p35696569p35859655.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p35859656p36011897.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p36011898p36181284.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p36181285p36352602.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p36352603p36395492.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p36395493p36563414.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p36563415p36705293.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p36705294p36860994.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p36860995p37026380.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p37026381p37213086.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p37213087p37411418.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p37411419p37578560.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p37578561p37756609.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p37756610p37930134.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p37930135p38093124.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p38093125p38270520.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p38270521p38449667.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p38449668p38635039.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p38635040p38789277.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p38789278p38969726.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p38969727p39145799.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p39145800p39323621.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p39323622p39482057.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p39482058p39648903.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p39648904p39826671.V2notext', 'enwiki-20220201-pages-meta-history21.xml-p39826672p39996245.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p39996246p40168011.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p40168012p40355564.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p40355565p40542256.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p40542257p40733962.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p40733963p40916512.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p40916513p41063393.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p41063394p41200327.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p41200328p41378646.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p41378647p41564903.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p41564904p41750479.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p41750480p41945621.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p41945622p42128585.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p42128586p42312100.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p42312101p42503002.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p42503003p42683786.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p42683787p42781206.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p42781207p42977614.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p42977615p43155873.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p43155874p43342160.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p43342161p43498048.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p43498049p43667043.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p43667044p43794879.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p43794880p43991921.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p43991922p44174619.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p44174620p44356092.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p44356093p44558067.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p44558068p44782960.V2notext', 'enwiki-20220201-pages-meta-history22.xml-p44782961p44788941.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p44788942p44983735.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p44983736p45229342.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p45229343p45399004.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p45399005p45590372.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p45590373p45889505.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p45889506p46257328.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p46257329p46442822.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p46442823p46612089.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p46612090p46788254.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p46788255p46929058.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p46929059p47118183.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p47118184p47299962.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p47299963p47484046.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p47484047p47660639.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p47660640p47843683.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p47843684p48020551.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p48020552p48319071.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p48319072p48528280.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p48528281p48733061.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p48733062p48937454.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p48937455p49140516.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p49140517p49366098.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p49366099p49607788.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p49607789p49875559.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p49875560p50128052.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p50128053p50394176.V2notext', 'enwiki-20220201-pages-meta-history23.xml-p50394177p50564553.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p50564554p50781343.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p50781344p51005848.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p51005849p51202810.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p51202811p51407986.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p51407987p51628333.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p51628334p51899234.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p51899235p52054909.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p52054910p52196086.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p52196087p52381111.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p52381112p52595847.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p52595848p52816085.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p52816086p53039743.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p53039744p53289524.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p53289525p53542038.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p53542039p53769542.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p53769543p53975843.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p53975844p54191605.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p54191606p54408629.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p54408630p54659207.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p54659208p54960364.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p54960365p55234989.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p55234990p55506348.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p55506349p55735771.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p55735772p55968114.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p55968115p56204124.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p56204125p56449227.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p56449228p56703866.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p56703867p56956000.V2notext', 'enwiki-20220201-pages-meta-history24.xml-p56956001p57025655.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p57025656p57276220.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p57276221p57472798.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p57472799p57728347.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p57728348p57980411.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p57980412p58203383.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p58203384p58518254.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p58518255p58795530.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p58795531p59090451.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p59090452p59425840.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p59425841p59578774.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p59578775p59842165.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p59842166p60141852.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p60141853p60424382.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p60424383p60693750.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p60693751p60994723.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p60994724p61233833.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p61233834p61448669.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p61448670p61733361.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p61733362p62016362.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p62016363p62317511.V2notext', 'enwiki-20220201-pages-meta-history25.xml-p62317512p62585850.V2notext', 'enwiki-20220201-pages-meta-history26.xml-p62585851p62781027.V2notext', 'enwiki-20220201-pages-meta-history26.xml-p62781028p62954813.V2notext', 'enwiki-20220201-pages-meta-history26.xml-p62954814p63197630.V2notext', 'enwiki-20220201-pages-meta-history26.xml-p63197631p63301935.V2notext', 'enwiki-20220201-pages-meta-history26.xml-p63301936p63431790.V2notext', 'enwiki-20220201-pages-meta-history26.xml-p63431791p63695926.V2notext', 'enwiki-20220201-pages-meta-history26.xml-p63695927p63975909.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p63975910p64282104.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p64282105p64587074.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p64587075p65013753.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p65013754p65412125.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p65412126p65729793.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p65729794p66040089.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p66040090p66317033.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p66317034p66691165.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p66691166p67106975.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p67106976p67480992.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p67480993p67845160.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p67845161p68254675.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p68254676p68626244.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p68626245p69077748.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p69077749p69532480.V2notext', 'enwiki-20220201-pages-meta-history27.xml-p69532481p69964648.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p100203p102953.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p102954p108010.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p108011p113766.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p113767p123426.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p123427p129593.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p129594p137892.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p137893p142724.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p142725p145581.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p145582p148399.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p148400p150643.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p150644p151573.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p41243p42800.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p42801p44060.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p44061p45323.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p45324p46759.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p46760p48247.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p48248p49701.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p49702p51274.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p51275p52553.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p52554p53825.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p53826p55307.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p55308p57108.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p57109p58596.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p58597p60033.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p60034p61833.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p61834p63837.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p63838p65524.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p65525p67061.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p67062p69322.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p69323p71480.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p71481p73298.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p73299p75320.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p75321p78254.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p78255p81295.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p81296p84243.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p84244p87995.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p87996p91627.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p91628p95441.V2notext', 'enwiki-20220201-pages-meta-history2.xml-p95442p100202.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p151574p154745.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p154746p158332.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p158333p160814.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p160815p163708.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p163709p166235.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p166236p168717.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p168718p171533.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p171534p174520.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p174521p178680.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p178681p182009.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p182010p186107.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p186108p189285.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p189286p192753.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p192754p197413.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p197414p202357.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p202358p206989.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p206990p211754.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p211755p216673.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p216674p222400.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p222401p228570.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p228571p233720.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p233721p239694.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p239695p243687.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p243688p248861.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p248862p253701.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p253702p261917.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p261918p266320.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p266321p273756.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p273757p283810.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p283811p288107.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p288108p294451.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p294452p299880.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p299881p303803.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p303804p307677.V2notext', 'enwiki-20220201-pages-meta-history3.xml-p307678p311329.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p311330p317563.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p317564p323857.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p323858p331180.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p331181p337757.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p337758p345673.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p345674p351482.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p351483p356173.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p356174p362734.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p362735p368797.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p368798p376178.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p376179p383286.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p383287p392487.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p392488p401484.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p401485p408744.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p408745p414848.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p414849p420401.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p420402p427339.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p427340p433832.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p433833p440048.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p440049p449687.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p449688p454853.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p454854p465477.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p465478p475452.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p475453p485722.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p485723p496408.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p496409p507725.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p507726p519563.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p519564p531709.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p531710p543918.V2notext', 'enwiki-20220201-pages-meta-history4.xml-p543919p558391.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p558392p564695.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p564696p572461.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p572462p581732.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p581733p594563.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p594564p606776.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p606777p617826.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p617827p625372.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p625373p638405.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p638406p650504.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p650505p664401.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p664402p678097.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p678098p690842.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p690843p705472.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p705473p721406.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p721407p736075.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p736076p751513.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p751514p768330.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p768331p791532.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p791533p814726.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p814727p842830.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p842831p858366.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p858367p873362.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p873363p887796.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p887797p901473.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p901474p917006.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p917007p934863.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p934864p952658.V2notext', 'enwiki-20220201-pages-meta-history5.xml-p952659p958045.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1001675p1016822.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1016823p1033838.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1033839p1052085.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1052086p1070475.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1070476p1090717.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1090718p1110513.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1110514p1129299.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1129300p1147713.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1147714p1169988.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1169989p1191980.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1191981p1212825.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1212826p1230757.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1230758p1249851.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1249852p1270443.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1270444p1294320.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1294321p1320433.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1320434p1344929.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1344930p1369110.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1369111p1397467.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1397468p1423767.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1423768p1446413.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1446414p1470141.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p1470142p1483661.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p958046p972035.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p972036p986144.V2notext', 'enwiki-20220201-pages-meta-history6.xml-p986145p1001674.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1483662p1511489.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1511490p1539537.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1539538p1565886.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1565887p1588249.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1588250p1610955.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1610956p1636067.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1636068p1659395.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1659396p1679345.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1679346p1702716.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1702717p1728481.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1728482p1756249.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1756250p1783980.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1783981p1809815.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1809816p1835384.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1835385p1860829.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1860830p1887497.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1887498p1915122.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1915123p1941399.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1941400p1952682.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1952683p1978945.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p1978946p2007594.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p2007595p2037345.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p2037346p2067466.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p2067467p2096486.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p2096487p2127348.V2notext', 'enwiki-20220201-pages-meta-history7.xml-p2127349p2134111.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2134112p2161296.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2161297p2187809.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2187810p2209933.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2209934p2236504.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2236505p2264907.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2264908p2293618.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2293619p2322250.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2322251p2350041.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2350042p2380254.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2380255p2406656.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2406657p2434067.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2434068p2458236.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2458237p2493378.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2493379p2519766.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2519767p2535881.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2535882p2535917.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2535918p2573609.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2573610p2604407.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2604408p2636143.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2636144p2670358.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2670359p2710477.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2710478p2752984.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2752985p2798752.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2798753p2838580.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2838581p2874541.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2874542p2913317.V2notext', 'enwiki-20220201-pages-meta-history8.xml-p2913318p2936260.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p2936261p2978040.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p2978041p3016684.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3016685p3055251.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3055252p3095790.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3095791p3135975.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3135976p3178577.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3178578p3219867.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3219868p3252667.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3252668p3291939.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3291940p3333721.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3333722p3382236.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3382237p3428721.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3428722p3464864.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3464865p3507092.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3507093p3532711.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3532712p3572671.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3572672p3615783.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3615784p3655524.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3655525p3703560.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3703561p3716239.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3716240p3741659.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3741660p3786422.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3786423p3838675.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3838676p3888418.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3888419p3946435.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p3946436p4000728.V2notext', 'enwiki-20220201-pages-meta-history9.xml-p4000729p4045402.V2notext']


# Alternatively, we can use `glob` to get a list of all files matching a pattern
#files = glob.glob(folder_in+"*.V2notext")


def progress_message(txt):
    """
    Simple function to print a timestamped message

    Parameters:
    txt (string): message to display

    Returns:
    None
    """
    # datetime object containing current date and time
    now = datetime.datetime.now()
    # time, formatted as dd/mm/YY H:M:S
    dt_string = now.strftime("%d/%m/%Y %H:%M:%S")
    # we print the time and the message
    print(dt_string, txt)


def extract_data(filename, folder):
    """
    Function that reads from an XML file, extracts some data, and saves to CSV.
    For this example, we extract timestamp and contributor

    Parameters:
    filename (string): full path to the XML file
    folder (strong): full path to the output folder

    Returns:
    None
    """
    # first, we read the file
    with open(filename, "r") as inFile:
        # Read each line in the file, readlines() returns a list of lines
        content = inFile.readlines()
        # Combine the lines in the list into a string
        content = "".join(content)
        bs_content = bs(content, "lxml")

    progress_message(f"Data in memory. Parsing.")

    # we extract the pages
    pages = bs_content.find_all("page")
    progress_message(f"{len(pages)} pages to process")

    nb_page_processed = 0

    # hacky way to create the ouput file name
    temp_name = filename.split("/")[-1]
    output_name = temp_name + ".csv"

    with open(folder + output_name, 'w') as outFile:

        # header line
        outFile.write("Page ID,Page title,Revision ID,Timestamp,Contributor ID,Contributor name\n")

        # for each page
        for p in pages:

            # we extract the page title
            title = p.find("title")
            title_value = str(title)[7:-8]
            # some page title have commas, so we need to escape them
            title_value = '"' + title_value + '"'

            # we extract the page ID
            ID = p.find("id")
            ID_value = str(ID)[4:-5]

            # we extract the revisions
            revisions = p.find_all("revision")

            # for each revision
            for r in revisions:

                # we extract the revision ID
                rev_ID = r.find("id")
                rev_ID_value = str(rev_ID)[4:-5]

                # we extract the timestamp
                rev_time = r.find("timestamp")
                rev_time_value = str(rev_time)[11:-12]

                # we extract the contributor
                contributor = r.find("contributor")

                # the contributor can be a registered user or an IP
                contributor_ID = contributor.find("id")
                if contributor_ID != None:
                    contributor_value = str(contributor_ID)[4:-5]
                    contributor_name = str(contributor.find("username"))[10:-11]

                    # same usernames have commas, so we need to escape them
                    contributor_name = '"' + contributor_name + '"'
                else:
                    contributor_IP = contributor.find("ip")
                    contributor_value = str(contributor_IP)[4:-5]
                    contributor_name = "N/A"

                outFile.write(
                    f"{ID_value},{title_value},{rev_ID_value},{rev_time_value},{contributor_value},{contributor_name}\n")

            nb_page_processed += 1
            # we show how much progress has been made
            if nb_page_processed % 100 == 0:
                progress_message(f"Processed {nb_page_processed} pages")


"""
Main part of the program.

Iterates over the list of files.
For each file, extracts data and saves to CSV.
"""

progress_message(f"Starting. Number of pages to process: {len(files)}")

for current_file in files:
    progress_message(f"Processing file {current_file}")
    extract_data(folder_in + current_file, folder_out)

progress_message("Done.")
